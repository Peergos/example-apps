(function(){let r,p,f;self.onmessage=async i=>{if(i.data.init&&!r){const{width:a,height:n}=i.data;r=new OffscreenCanvas(a,n),p=r.getContext("2d"),f=!1}else if(i.data.pixels){if(f)return;f=!0;const a=i.data.pixels;w(a,p),createImageBitmap(r).then(n=>{postMessage({bitmap:n}),f=!1})}};const e=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];function w(i,a){function n(l,o,t,d,u){a.beginPath(),a.moveTo(0,d);let m=0;for(let h=0;h<256;h++){const b=Math.round(o[h]*d/u);m=Math.round(h*t/255),a.lineTo(m,d-b)}a.lineTo(m,d),a.fillStyle=l,a.fill(),a.closePath()}e[0].fill(0),e[1].fill(0),e[2].fill(0);const s=[0,0,0];for(let l=0;l<i.length;++l){const o=i[l],t=l%4;t<3&&o>2&&o<253&&(++e[t][o],e[t][o]>s[t]&&++s[t])}const{width:c,height:g}=a.canvas;a.clearRect(0,0,c,g),a.globalCompositeOperation="lighter",a.globalAlpha=1,n("#c13119",e[0],c,g,s[0]),n("#0c9427",e[1],c,g,s[1]),n("#1e73be",e[2],c,g,s[2])}})();
